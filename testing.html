<!DOCTYPE text/html>
<html>
<head>
  <title>
    Fortz.io
  </title>
  <style>
    body {margin: 0;}
    canvas {width: 100%; height: 100%;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.7.1/pixi.min.js"></script>
</head>
<body>
  <script>
    let app = new PIXI.Application({width: window.innerWidth, height: window.innerHeight});
    document.body.appendChild(app.view);
    app.renderer.backgroundColor = 0x33cc33;
    app.renderer.autoResize = true;

function keyboard(keyCode) {
  let key = {};
  key.code = keyCode;
  key.isDown = false;
  key.isUp = true;
  key.press = undefined;
  key.release = undefined;
  //The `downHandler`
  key.downHandler = event => {
    if (event.keyCode === key.code) {
      if (key.isUp && key.press) key.press();
      key.isDown = true;
      key.isUp = false;
    }
    event.preventDefault();
  };

  //The `upHandler`
  key.upHandler = event => {
    if (event.keyCode === key.code) {
      if (key.isDown && key.release) key.release();
      key.isDown = false;
      key.isUp = true;
    }
    event.preventDefault();
  };

  //Attach event listeners
  window.addEventListener(
    "keydown", key.downHandler.bind(key), false
  );
  window.addEventListener(
    "keyup", key.upHandler.bind(key), false
  );
  return key;
}
   var nick;

    PIXI.loader.add("sprites/nickCage.png").load(setup);
 function setup() {
      var texture = PIXI.loader.resources["sprites/nickCage.png"].texture;;
      nick = new PIXI.Sprite(texture);
      app.stage.addChild(nick);
let left=keyboard(37);
let up=keyboard(38); 
let right=keyboard(39); 
let down=keyboard(40); 

left.press = () => {
nick.vx=-5;
nick.vy=0;
};
right.press = () => {
nick.vx=5;
nick.vy=0;
};
up.press = () => {
nick.vy=-5;
nick.vx=0;
};
down.press = () => {
nick.vy=5;
nick.vx=0;
};
left.release = () => {
if(!right.isDown&&nick.vy===0){
nick.vx=0;
}
};
right.release = () => {
if(!left.isDown&&nick.vy===0){
nick.vx=0;
}
};
up.release = () => {
if(!down.isDown&&nick.vx===0){
nick.vy=0;
}
};
down.release = () => {
if(!up.isDown&&nick.vx===0){
nick.vy=0;
}
};

     app.ticker.add(delta => gameloop(delta));   
 }
    function gameloop(delta){
      nick.x+=nick.vx;
	nick.y+=nick.vy;
 }
            

  </script>
</body>
</html>
